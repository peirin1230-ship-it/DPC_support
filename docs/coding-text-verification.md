# DPCコーディングテキスト準拠 検証レポート

令和6年度 DPC/PDPS傷病名コーディングテキストの主要ルールと本システムの仕様を照合した結果です。

---

## 検証日

2026年2月11日

## 参照資料

- [DPC/PDPS 傷病名コーディングテキスト 改定版（第6版）](https://www.mhlw.go.jp/content/12404000/001394024.pdf)
- [診断群分類区分の決定について - 田辺ファーマ](https://medical.tanabe-pharma.com/articles/dpc-manual/06.shtml)
- [DPCコードの構成と意味 - 田辺ファーマ](https://medical.tanabe-pharma.com/articles/dpc-manual/05.shtml)
- [DPCコードとツリー図 - 田辺ファーマ](https://medical.tanabe-pharma.com/articles/dpc-manual/04.shtml)
- [050050 狭心症、慢性虚血性心疾患 2024/2025年度DPC - DPC Web辞書](https://bone.jp/dpc/24/050050.html)
- [DPCデータの一言コラム 第３回 - PRRISM](https://www.prrism.com/newscolumns/2024/)
- [DPC分類の定義・点数・日数とツリー図 - DPC Web辞書](https://bone.jp/dpc/)

---

## 総合判定

| ルール | 判定 | 備考 |
|---|---|---|
| 14桁コード構成 | **適合** | 3,248コード正しく管理 |
| 下から優先ルール | **適合** | corrValベースの優先度フィルタ |
| 手術区分 97/99 | **適合** | validSvフィルタで正確な表示 |
| 処置等の分岐 | **適合** | 臨床ルールはユーザー判断に委ねる設計 |
| 定義副傷病 | **適合** | データ上フラグ1のみだが正しく動作 |
| 重症度分岐 | **適合** | 全値表示・該当値強調 |
| 出来高算定 | **適合** | 手術警告・DPCラベル・フラグ判定 |
| 期間Ⅰ/Ⅱ/Ⅲ算定 | **適合** | 総点数計算・期間超過表示 |

**結論: 本システムはDPCコーディングテキストの主要ルールに準拠しています。**

---

## 検証詳細

### 1. 14桁DPCコードの構成

**コーディングテキストの規定:**

| 桁 | 内容 |
|---|---|
| 1-2桁 | MDC（主要診断群、01〜18） |
| 3-6桁 | 疾患分類コード |
| 7桁目 | 病態等分類 |
| 8桁目 | 年齢・体重・JCS等 |
| 9-10桁目 | 手術区分（01〜07:定義手術、97:その他手術あり、99:手術なし） |
| 11桁目 | 手術・処置等1 |
| 12桁目 | 手術・処置等2 |
| 13桁目 | 定義副傷病 |
| 14桁目 | 重症度等 |

**本システムの実装:**

`D.dpc[code] = [mdc2桁, cls4桁, 出来高フラグ, 手術区分, p1, p2, 副傷病, 日数×3, 点数×3]`

**判定: 適合** — 14桁コード3,248件を正しく格納。MDC18区分・506分類を網羅。手術区分01〜07, 97, 99が全て存在。

---

### 2. ツリー図の「下から優先」ルール

**コーディングテキストの規定:**

> 入院中に定義テーブルに記載された複数の手術等の診療行為を行い、同一疾患内の複数のDPCコードに該当する可能性がある場合は、「手術」「手術・処置等１」「手術・処置等２」「定義副傷病」の全項目において、**診断群分類定義樹形図の下から掲げられた診断群分類を優先して選択する**。

**本システムの実装:**

- corrVal（相関値）で優先度を管理。数値が大きい = ツリー図で下 = 高優先度
- `getBranchOptions`関数: ドリルダウンで選択した項目のcorrValより**大きい**corrValの項目のみ表示
- `parseInt(v, 36)`でbase-36パース（一部分類で英字corrVal A, B等を使用するため）

**具体例 — 050050（狭心症）処置等2:**

| corrVal | ツリー図の位置 | 項目例 | システム表示 |
|---|---|---|---|
| 1 | 上（低優先） | G005 中心静脈注射 | 初期表示あり |
| 2 | 中 | J0384 人工腎臓 | G005選択後に表示 |
| 3 | 下（高優先） | 0022 SPECT | J0384選択後に表示 |

**判定: 適合** — corrVal比較によるフィルタリングが「下から優先」ルールを正しく実装。

---

### 3. 手術区分の取り扱い

**コーディングテキストの規定:**

- 97: **その他手術あり**（定義テーブルに明記されていない手術を実施した場合）
- 99: **手術なし**
- 01〜07: 定義テーブルで定義された特定の手術

**本システムの実装:**

- `searchDPC`: 手術コード`KKK0`で検索すると`surgVal="99"`（手術なし）を返す
- `Detail.jsx`: 手術定義セクションで、**実際にDPCエントリが存在する手術区分のみ表示**（`validSv`による制御）

**判定: 適合** — 97/99を含む全手術区分を正しく処理。`validSv`フィルタにより、DPCエントリが存在しない架空の手術区分は表示されない。

---

### 4. 手術・処置等の選択と分岐

**コーディングテキストの規定:**

- 複数の処置等に該当する場合は、ツリー図で下に掲げられたものを優先
- 化学療法と放射線療法の両方を行った場合は「放射線療法あり」を選択
- 手術中に行った化学療法のみでは「化学療法あり」を選択不可
- G006植込型カテーテルによる中心静脈注射を実施しても、G005を選択不可

**本システムの実装:**

- 処置等の全項目を表示し、ユーザーがドリルダウンで選択
- corrValベースの優先度フィルタで「下から優先」を実現
- 臨床的判断ルール（化学療法・放射線療法の同時実施ルール等）はシステム側では強制していない

**判定: 概ね適合** — 優先度による分岐フィルタリングは正しく実装されている。G005/G006の使用条件や化学療法の適用条件などの**臨床的コーディングルール**はシステム上の制約としては実装されていない。これらは医師・コーダーの判断に委ねられるもので、検索ツールとしては妥当な設計。

---

### 5. 定義副傷病の判定

**コーディングテキストの規定:**

- 入院時併存症と入院後発症傷病の両方が含まれる（疑い病名は除く）
- フラグ1: 手術あり・なし共通
- フラグ2: 手術なしの場合のみ
- フラグ3: 手術ありの場合のみ

**本システムの実装:**

- `D.sd[cls][sdVal]`: 副傷病の対象ICDコード一覧
- `getSubdiagICDs(cls, sdVal)`: 分類と副傷病値からICD一覧を取得
- データ調査結果: **D.sdにはフラグ"1"のみが存在**（フラグ2, 3は未使用）

**判定: 適合（データ制約内で正しい）** — 現在のデータセットではフラグ"1"（手術有無共通）のみが存在。各DPCエントリ（D.dpc）自体が手術区分ごとに個別に副傷病分岐を持つため、「手術99のDPCでsdVal=1」と「手術01のDPCでsdVal=1」は別のDPCエントリとして正しく管理されている。D.br（分岐定義）もsurgValごとに副傷病分岐("s")の有無を管理。

---

### 6. 重症度等の分岐

**コーディングテキストの規定:**

- 疾患ごとに固有の判定基準
  - 急性膵炎: 2008年改訂の重症度判定基準
  - 脳梗塞: 発症時期に基づく選択
  - 肺炎: A-DROPスコア（年齢、BUN値、酸素飽和度、意識障害、血圧の5項目）
  - 肝硬変: Child-Pugh分類
- 不明の場合は「軽症」を選択

**本システムの実装:**

- `D.sv[cls]`: 分類ごとの重症度定義（名称 + 値→ラベル）
- `getSevInfo(cls, dpc)`: DPCコード14桁目から重症度情報を取得
- `Detail.jsx`: 重症度分岐を全値表示し、現在のDPCに該当する値を黄色で強調

**判定: 適合** — 重症度情報を正しく表示。個別疾患の判定基準（A-DROPスコアの計算方法等）は臨床的判断であり、検索ツールとしてはDPC内の重症度値とラベルの表示で十分。

---

### 7. 出来高算定

**コーディングテキストの規定:**

- ツリー図で実線=包括評価（2,477分類）、点線=出来高算定
- 包括評価に適さないものは出来高で算定
- 出来高算定手術がある

**本システムの実装:**

- `D.dk[kCode]`: 出来高算定手術の判定テーブル
- `isDekidakaOp(kCode)`: Kコードが出来高対象か判定
- 検索時に出来高手術選択で警告バナーを表示
- DPCカードに赤い「出来高」ラベルを表示
- `D.dpc`の`info[2]`（出来高フラグ）でDPCごとの包括/出来高を判定

**判定: 適合** — 出来高算定を正しく識別・表示。

---

### 8. 包括評価の算定方法（期間Ⅰ/Ⅱ/Ⅲ）

**コーディングテキストの規定:**

- 入院期間に応じて期間Ⅰ（高点数）→ 期間Ⅱ → 期間Ⅲの3段階で点数が逓減
- 期間Ⅲを超えた日数は出来高算定

**本システムの実装:**

- `calcTotal(days, pts, sd)`: 入院日数に応じた総点数計算
- 期間Ⅲ超過分を`overDays`として算出し、「出来高○日」と赤字表示
- 比較モーダルで各期間の点数・日数を色分け比較

**判定: 適合** — 3期間の点数計算と期間超過の出来高表示を正しく実装。

---

## 補足: システムの設計方針

本システムは**DPCコード検索・支援ツール**であり、以下の臨床的コーディングルールについてはシステム上の制約として実装せず、ユーザー（医師・診療情報管理士）の判断に委ねる設計としています。

- 「医療資源を最も投入した傷病名」の選択判断
- 化学療法と放射線療法の同時実施時の選択ルール
- 手術中に行った化学療法のみでの「化学療法あり」選択不可ルール
- G006植込型カテーテルとG005中心静脈注射の使い分け
- 他院転院時の「手術なし」選択ルール
- 重症度判定基準の具体的な計算（A-DROPスコア等）

これらは診療行為の臨床的文脈に依存するため、検索ツールとしては該当する選択肢を提示し、最終的な判断をユーザーに委ねることが適切です。
